<div class="tabs">
  <ng-container *ngIf="admin.status.plugins.comment">
    <a routerLink="./comments" routerLinkActive="current-tab">comments</a>
  </ng-container>
  <a routerLink="./responses" routerLinkActive="current-tab">responses</a>
  <a routerLink="./sources" routerLinkActive="current-tab">sources</a>
  <a routerLink="./missing" routerLinkActive="current-tab">missing sources</a>
  <ng-container *ngIf="admin.status.plugins.graph">
    <a routerLink="./graph" [queryParams]="{ hideSearch: true }" routerLinkActive="current-tab">graph</a>
  </ng-container>
  <div class="spacer"></div>
  <app-settings></app-settings>
</div>
<app-sidebar *ngIf="!(hideSearch$ | async)" class="aside"></app-sidebar>
<div *ngIf="!error; else errorMessage">
  <ng-container *ngIf="ref$ | async as ref; else loading">
    <app-ref class="full-page"
             [ref]="ref"
             [showToggle]="true"
             [expandInline]="true"
             [expanded]="isTextPost"></app-ref>
  </ng-container>
  <ng-template #loading>
    <app-loading></app-loading>
  </ng-template>
  <router-outlet></router-outlet>
</div>
<ng-template #errorMessage>
  <ng-container *ngIf="error!.status === 404 && account.signedIn">
    <div class="stack">
      <div class="error-404">Not Found</div>
      <ng-container *ngIf="account.signedIn">
        <div *ngIf="!isTextPost" class="error-404 submit-button" routerLink="/submit" [queryParams]="{ url: url$ | async }">
          🔗 Submit Link
        </div>
        <div *ngIf="isTextPost" class="error-404 submit-button" routerLink="/submit/text" [queryParams]="{ url: url$ | async }">
          📝 Submit Text Post
        </div>
      </ng-container>
    </div>
  </ng-container>
  <div *ngIf="error!.status !== 404" class="error">{{ printError(error!) }}</div>
</ng-template>

<ng-container *mobxAutorun>
  <div class="tabs">
    <ng-container *ngIf="admin.status.plugins.comment">
      <a routerLink="./comments" [queryParams]="{origin: store.view.origin}" routerLinkActive="current-tab">comments</a>
    </ng-container>
    <a routerLink="./responses" [queryParams]="{origin: store.view.origin}" routerLinkActive="current-tab">responses</a>
    <a routerLink="./sources" [queryParams]="{origin: store.view.origin}" routerLinkActive="current-tab">sources</a>
    <a routerLink="./missing" [queryParams]="{origin: store.view.origin}" routerLinkActive="current-tab">missing sources</a>
    <a routerLink="./alts" [queryParams]="{origin: store.view.origin}" routerLinkActive="current-tab">alts</a>
    <a *ngIf="error && store.view.remoteCount || store.view.remoteCount > 1" routerLink="./remotes" [queryParams]="{origin: store.view.origin}" routerLinkActive="current-tab">remotes</a>
    <ng-container *ngIf="admin.status.plugins.graph">
      <a routerLink="./graph" [queryParams]="{ origin: store.view.origin, hideSearch: true }" routerLinkActive="current-tab">graph</a>
    </ng-container>
    <app-settings></app-settings>
  </div>
  <app-sidebar *ngIf="!store.view.hideSearch" class="aside"></app-sidebar>
  <ng-container *ngIf="!error; else errorMessage">
    <ng-container *ngIf="store.view.ref else loading">
      <app-ref class="full-page"
               [ref]="store.view.ref"
               [showToggle]="true"
               [expandInline]="true"
               [expanded]="!!store.view.ref.comment"></app-ref>
      <div *ngIf="refWarning"
           class="warning">
        * Published date was changed to be after source published date.
      </div>
    </ng-container>
    <ng-template #loading>
      <app-loading></app-loading>
    </ng-template>
    <router-outlet></router-outlet>
  </ng-container>
  <ng-template #errorMessage>
    <ng-container *ngIf="error!.status === 404">
      <div class="stack">
        <div class="error-404">Not Found</div>
        <ng-container *ngIf="store.account.signedIn">
          <div *ngIf="!store.view.isTextPost && !store.view.isWikiPost" class="error-404 submit-button" routerLink="/submit" [queryParams]="{ url: store.view.url }">
            🔗 Submit Link
          </div>
          <div *ngIf="store.view.isTextPost" class="error-404 submit-button" routerLink="/submit/text" [queryParams]="{ url: store.view.url }">
            📝 Submit Text Post
          </div>
          <div *ngIf="store.view.isWikiPost" class="error-404 submit-button" routerLink="/submit/text" [queryParams]="{ url: store.view.url }">
            📔 &nbsp; Submit Wiki
          </div>
        </ng-container>
      </div>
    </ng-container>
    <div *ngIf="error!.status !== 404" class="error">{{ printError(error!) }}</div>
  </ng-template>
</ng-container>

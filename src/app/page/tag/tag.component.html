<ng-container *mobxAutorun>
  <div class="tabs">
    <h5 class="fake-link" routerLink=".." [queryParams]="{}">{{ store.view.name }}</h5>
    <a routerLink="../created" [queryParams]="{pageNumber: null}" queryParamsHandling="merge" routerLinkActive="current-tab" title="Sort by created date">new</a>
    <ng-container *ngIf="admin.status.plugins.comment">
      <a routerLink="../commentCount" [queryParams]="{pageNumber: null}" queryParamsHandling="merge" routerLinkActive="current-tab" title="Sort by number of comments">comments</a>
    </ng-container>
    <a routerLink="../sourceCount" [queryParams]="{pageNumber: null}" queryParamsHandling="merge" routerLinkActive="current-tab" title="Sort by number of sources">sources</a>
    <a routerLink="../responseCount" [queryParams]="{pageNumber: null}" queryParamsHandling="merge" routerLinkActive="current-tab" title="Sort by number of responses">responses</a>
    <a routerLink="../published" [queryParams]="{pageNumber: null}" queryParamsHandling="merge" routerLinkActive="current-tab" title="Sort by published date">published</a>
    <a routerLink="../modified" [queryParams]="{pageNumber: null}" queryParamsHandling="merge" routerLinkActive="current-tab" title="Sort by modified date">modified</a>
    <a routerLink="../title" [queryParams]="{pageNumber: null}" queryParamsHandling="merge" routerLinkActive="current-tab" title="Sort alphabetically by title">title</a>
    <a *ngIf="store.view.search" routerLink="../rank" [queryParams]="{pageNumber: null}" queryParamsHandling="merge" routerLinkActive="current-tab" title="Sort by search relevance">rank</a>
    <ng-container *ngIf="admin.status.plugins.graph">
      <a routerLink="./"
         [class.current-tab]="store.view.graph"
         [queryParams]="{ graph: store.view.graph ? null : true, list: null }"
         queryParamsHandling="merge"
         title="Graph these results">graph</a>
    </ng-container>
    <ng-container *ngIf="store.view.kanban">
      <a routerLink="./"
         [class.current-tab]="store.view.list"
         [queryParams]="{ list: store.view.list ? null : true, graph: null }"
         queryParamsHandling="merge"
         title="View as list">list</a>
    </ng-container>
    <div class="spacer"></div>
    <app-settings></app-settings>
  </div>
  <app-sidebar class="aside"
               *ngIf="!store.view.graph"
               [tag]="store.view.tag!"
               [ext]="store.view.ext"></app-sidebar>
  <div *ngIf="query.error?.status === 403 else accessGranted" class="error-403">Access Denied</div>
  <ng-template #accessGranted>
    <!-- TODO: allow paging with graph -->
    <app-ref-list *ngIf="isList else special"
                  [page]="query.page"
                  [pinned]="store.view.pinned"
                  [tag]="store.view.tag"
                  [graph]="store.view.graph"></app-ref-list>
    <ng-template #special>
      <app-kanban *ngIf="store.view.kanban"
                  [tag]="store.view.tag!"></app-kanban>
    </ng-template>
  </ng-template>

</ng-container>

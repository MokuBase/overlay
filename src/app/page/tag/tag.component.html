<ng-container *mobxAutorun>
  <div class="tabs">
    <h5 class="fake-link" routerLink=".." [queryParams]="{}">{{ store.view.name }}</h5>
    <ng-container *ngIf="store.view.kanban">
      <a routerLink="./"
         [class.current-tab]="store.view.noView"
         [queryParams]="{view: null}"
         queryParamsHandling="merge">kanban</a>
    </ng-container>
    <ng-container *ngIf="store.view.blog">
      <a routerLink="./"
         [class.current-tab]="store.view.noView"
         [queryParams]="{view: null}"
         queryParamsHandling="merge">blog</a>
    </ng-container>
    <ng-container *ngIf="store.view.chat">
      <a routerLink="./"
         [class.current-tab]="store.view.noView"
         [queryParams]="{view: null}"
         queryParamsHandling="merge">chat</a>
    </ng-container>
    <a routerLink="./"
       [class.current-tab]="isSpecial ? store.view.list : store.view.noView"
       [queryParams]="{view: isSpecial ? 'list' : null}"
       queryParamsHandling="merge">list</a>
    <ng-container *ngIf="admin.status.plugins.graph">
      <a routerLink="./"
         [class.current-tab]="store.view.graph"
         [queryParams]="{view: 'graph'}"
         queryParamsHandling="merge" >graph</a>
    </ng-container>
    <app-settings></app-settings>
  </div>
  <app-sidebar class="aside"
               *ngIf="!store.view.graph"
               [tag]="store.view.tag!"
               [ext]="store.view.ext"
               [showSort]="!(store.view.chat && store.view.noView)"></app-sidebar>
  <div *ngIf="query.error?.status === 403 else accessGranted" class="error-403">Access Denied</div>
  <ng-template #accessGranted>
    <!-- TODO: allow paging with graph -->
    <app-ref-list *ngIf="isList else special"
                  [page]="query.page"
                  [pinned]="store.view.pinned"
                  [tag]="store.view.tag"
                  [graph]="store.view.graph"></app-ref-list>
    <ng-template #special>
      <app-kanban *ngIf="store.view.kanban"
                  [tag]="store.view.tag!"></app-kanban>
      <app-chat *ngIf="store.view.chat"
                [query]="store.view.tag!"
                [addTags]="['public', 'internal', store.view.localTag]"></app-chat>
      <app-blog *ngIf="store.view.blog"
                [tag]="store.view.tag!"
                [page]="query.page"
                [pinned]="store.view.pinned"></app-blog>
    </ng-template>
  </ng-template>

</ng-container>

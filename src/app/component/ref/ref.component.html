<div class="link">
  <a *ngIf="webLink" [href]="ref.url">{{ ref.title || ref.url }}</a>
  <a *ngIf="!webLink" [routerLink]="['/ref/comments/', ref.url]">{{ ref.title || ref.url }}</a>
  <span class="host">({{ host }})</span>
</div>
<div class="link-below">
  <div class="toggle"
       *ngIf="showToggle && expandPlugin"
       (click)="expanded = !expanded">
    <span *ngIf="!expanded">+</span>
    <span *ngIf="expanded">x</span>
  </div>
  <div class="stack">
    <div class="info">
      submitted {{ ref.created?.fromNow() }}
      <ng-container *ngIf="authors.length">
        by
        <ng-container *ngFor="let user of authors">
          <a [routerLink]="['/tag', user]">{{ user.replace('user/', '') + ref.origin }}</a>&nbsp;
        </ng-container>
      </ng-container>
      <ng-container *ngIf="tags.length">
        tagged
        <ng-container *ngFor="let tag of tags">
          <a [routerLink]="['/tag', tag]">{{ tag }}</a>&nbsp;
        </ng-container>
      </ng-container>
    </div>
    <div class="expand" *ngIf="ref.comment && !showToggle">
      {{ ref.comment }}
    </div>
    <div class="actions">
      <a [routerLink]="['/ref/comments/', ref.url]">{{ comments }}</a>
      <a [routerLink]="['/ref/responses/', ref.url]">{{ responses }}</a>
      <a [routerLink]="['/ref/sources/', ref.url]">{{ sources }}</a>
      <a [routerLink]="['/ref/graph/', ref.url]">graph</a>
      <a class="fake-link" *ngIf="writeAccess$ | async" (click)="tagging = !tagging">tag</a>
      <span *ngIf="tagging" class="inline-tagging">
      <input #inlineTag
             (keydown)="$event.key === 'Enter' && addInlineTag() || true"
             type="text"
             pattern="_?[a-z]+(/[a-z]+)*"
             appAutofocus>
      <button (click)="addInlineTag()">+</button>
    </span>
    </div>
  </div>
</div>
<div class="expand" *ngIf="expanded && expandPlugin && showToggle">
  {{ ref.comment }}
</div>
